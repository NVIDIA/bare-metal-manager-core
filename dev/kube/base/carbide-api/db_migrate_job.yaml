apiVersion: batch/v1
kind: Job
metadata:
  name: carbide-db-migrations
spec:
  template:
    spec:
      containers:
      - name: carbide-db-migrations
        image: carbide:latest
        command: ["sh",  "-c", "/opt/carbide/carbide-api migrate --datastore=\"${CARBIDE_API_DATASTORE}\""]
        envFrom:
        - configMapRef:
            name:  carbide-api-configuration
        imagePullPolicy:  IfNotPresent
      restartPolicy: OnFailure
