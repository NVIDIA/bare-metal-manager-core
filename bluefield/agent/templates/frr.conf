# Auto-generated by Forge.
!---- Cumulus Defaults ----
frr defaults datacenter
log syslog informational
no zebra nexthop kernel enable
!---- Rendered frr.conf ----
vrf default
{{- range .AccessVLANs}}
{{- if .HostRoute }}
ip route {{ .HostRoute }} vlan{{ .ID }}
{{- end }}
{{- end }}
exit-vrf
router bgp {{ .ASN }} vrf default
bgp router-id {{ .LoopbackIP }}
bgp bestpath as-path multipath-relax
timers bgp 3 9
bgp deterministic-med
! Neighbors
neighbor {{ .UplinkPeerGroup }} peer-group
neighbor {{ .UplinkPeerGroup }} remote-as external
neighbor {{ .UplinkPeerGroup }} timers 3 9
neighbor {{ .UplinkPeerGroup }} timers connect 10
neighbor {{ .UplinkPeerGroup }} advertisement-interval 0
no neighbor {{ .UplinkPeerGroup }} capability extended-nexthop
{{ $outer := . }}
{{- range .Uplinks }}
neighbor {{ . }} interface peer-group {{ $outer.UplinkPeerGroup }}
{{- end }}
! Address families
address-family ipv4 unicast
network {{ .LoopbackIP }}/32
{{- range .AccessVLANs }}
{{- if .HostRoute }}
network {{ .HostRoute }}
{{- end }}
{{- end }}
maximum-paths ibgp 64
maximum-paths 64
distance bgp 20 200 200
neighbor {{ .UplinkPeerGroup }} activate
neighbor {{ .UplinkPeerGroup }} allowas-in
neighbor {{ .UplinkPeerGroup }} prefix-list {{ .FromUnderlayRouteFilterName }} in
neighbor {{ .UplinkPeerGroup }} route-map {{ .ToUnderlayRouteFilterName }} out
exit-address-family
address-family l2vpn evpn
advertise-all-vni
neighbor {{ .UplinkPeerGroup }} activate
neighbor {{ .UplinkPeerGroup }} allowas-in
exit-address-family
! end of router bgp {{ .ASN }} vrf default
{{- if .ImportDefaultRouteOnly }}
ip prefix-list {{ .FromUnderlayRouteFilterName }} seq 10 permit 0.0.0.0/0
ip prefix-list {{ .FromUnderlayRouteFilterName }} seq 65535 deny any
{{- else }}
ip prefix-list {{ .FromUnderlayRouteFilterName }} seq 65535 permit any
{{- end }}
{{- range .AccessVLANs}}
route-map {{ $outer.ToUnderlayRouteFilterName }} deny {{ .ID }}
match interface vlan{{ .ID }}
{{- end }}
route-map {{ .ToUnderlayRouteFilterName }} permit 65535
!---- CUE snippets ----
ip nht resolve-via-default
