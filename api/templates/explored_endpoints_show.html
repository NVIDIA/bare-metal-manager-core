{% extends "base.html" %}

{% block title %}{{ filter_name }} Explored Endpoints{% endblock %}

{% block css %}
  form#filter-container {
      margin: 20px 0;
      display: flex;
      align-items: center;
      gap: 20px;
  }

  form#filter-container label {
      font-weight: bold;
  }

  form#filter-container select, form#filter-container input[type="checkbox"] {
      padding: 5px;
      border: 1px solid #999;
      outline: none;
  }
  form#filter-container select {
      height: 30px;
  }
  form#filter-container input[type="checkbox"] {
      width: 20px;
      height: 20px;
  }
{% endblock %}

{% block content %}
{% if filter_name == "All" %}
<div id="json"><a id="json-link" href="">JSON</a></div>
{% endif %}

<h1>{{ filter_name }} Explored Endpoints</h1>

<form id="filter-container" action="" method="get">
  <div>
      <label for="vendor-filter">Vendor:</label>
      <select id="vendor-filter" name="vendor-filter">
          <option value="ALL">All</option>
          {% for v in vendors %}
          <option value="{{ v|upper }}" {% if active_vendor_filter == v.to_uppercase() %}selected{% endif %}>{{ v|capitalize }}</option>
          {% endfor %}
          <option value="NONE"{% if active_vendor_filter == "NONE" %}selected{% endif %}>None</option>
      </select>
  </div>
  <div>
      <label for="errors-only">Errors only:</label>
      <input type="checkbox" id="errors-only" name="errors-only" {% if is_errors_only %}checked{% endif %}>
  </div>
  <div>
      <input type="submit" value="Update">
  </div>
</form>

<table>
	<thead>
		<tr>
			<th>Address</th>
			<th>Endpoint Type</th>
			<th>BMC MAC</th>
			<th>Vendor</th>
			<th>Machine ID</th>
			<th>Serial Numbers</th>
			<th>Last Exploration Error</th>
		</tr>
	</thead>
	<tbody>
		{% for ep in endpoints %}
		<tr>
			<td><a href="/admin/explored_endpoint/{{ ep.address }}">{{ ep.address }}</a></td>
			<td>{{ ep.endpoint_type }}</td>
			<td>{{ ep.bmc_mac_addrs|join("\n")|escape|linebreaksbr|safe }}</td>
			<td>{{ ep.vendor }}</td>
			<td>{{ ep.machine_id|machine_id_link|safe }}</td>
			<td>{{ ep.serial_numbers|join("\n")|escape|linebreaksbr|safe }}</td>
			<td>{{ ep.last_exploration_error }}</td>
		</tr>
		{% endfor %}
	</tbody>
  <tfoot>
    <tr>
      <th>{{ endpoints.len() }} item{% if endpoints.len() != 1 %}s{% endif %}</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </tfoot>
</table>

{% endblock %}
