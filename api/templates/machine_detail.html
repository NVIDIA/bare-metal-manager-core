{% extends "base.html" %}

{% block title %}{{ id }}{% endblock %}

{% block content %}
<h1>{{ machine_type }} {{ hostname }}</h1>

<table>
	<tr><th>ID</th><td>{{ id }}</td></tr>
	{% if !is_host %}
		<tr><th>Host ID</th><td><a href="/admin/managed-host/{{ host_id }}">{{ host_id }}</a></td></tr>
	{% endif %}
	<tr><th>State</th><td>{{ state }} for {{ time_in_state }} {{ state_reason }}</td></tr>
	<tr><th>State Version</th><td>{{ state_version }}</td></tr>
	{% if !network_config.is_empty() %}
	<tr>
		<th>Network config (sent to forge-dpu-agent)</th>
		<td style="height: 10em"><div style="height: 100%; overflow: auto; margin: 0; padding: 0;"><pre><code>{{ network_config }}</code></pre></div></td>
	</tr>
	{% endif %}
	<tr><th>Sys Vendor</th><td>{{ sys_vendor }}</td></tr>
	<tr><th>Product Name</th><td>{{ product_name }}</td></tr>
	<tr><th>Product Serial</th><td>{{ product_serial }}</td></tr>
	<tr><th>Chassis Serial</th><td>{{ chassis_serial }}</td></tr>
	<tr><th>Board Serial</th><td>{{ board_serial }}</td></tr>
	<tr><th>Bios Version</th><td>{{ bios_version }}</td></tr>
	<tr><th>Board Version</th><td>{{ board_version }}</td></tr>
</table>

<h3>Interfaces</h3>
{% for interface in interfaces %}
<table>
	<tr><th>Index</th><td>{{ interface.index }}</td></tr>
	<tr><th>ID</th><td><a href="/admin/interface/{{ interface.id }}">{{ interface.id }}</a></td></tr>
	{% if is_host %}
		<tr><th>DPU ID</th><td><a href="/admin/machine/{{ interface.dpu_id }}">{{ interface.dpu_id }}</a></td></tr>
	{% endif %}
	<tr><th>Segment ID</th><td><a href="/admin/network-segment/{{ interface.segment_id }}">{{ interface.segment_id }}</a></td></tr>
	<tr><th>Domain ID</th><td>{{ interface.domain_id }}</td></tr>
	<tr><th>Hostname </th><td>{{ interface.hostname }}</td></tr>
	<tr><th>Primary</th><td>{{ interface.primary }}</td></tr>
	<tr><th>MAC Address</th><td>{{ interface.mac_address }}</td></tr>
	<tr><th>Addresses</th><td>{{ interface.addresses }}</td></tr>
</table>
{% endfor %}

{% if is_host %}
<h3>InfiniBand Interfaces</h3>
<table>
	<thead>
		<tr>
			<th>Device</th>
			<th>Vendor</th>
			<th>GUID</th>
			<th>Slot</th>
		</tr>
	</thead>
	<tbody>
	{% for interface in ib_interfaces %}
		<tr>
			<td>{{ interface.device }}</td>
			<td>{{ interface.vendor }}</td>
			<td>{{ interface.guid }}</td>
			<td>{{ interface.slot }}</td>
		</tr>
	{% endfor %}
	</tbody>
</table>
{% endif %}

<h3>Inventory</h3>
<table>
	<thead>
		<tr>
			<th>Name</th>
			<th>Version</th>
			<th>URL</th>
		</tr>
	</thead>
	<tbody>
	{% for item in inventory %}
		<tr>
			<td>{{ item.name }}</td>
			<td>{{ item.version }}</td>
			<td>{{ item.url }}</td>
		</tr>
	{% endfor %}
	</tbody>
</table>

<h3>History</h3>
<table>
	<thead>
		<tr>
			<th>State</th>
			<th>Version</th>
			<th>Time</th>
		</tr>
	</thead>
	<tbody>
	{% for event in history %}
		<tr>
			<td>{{event.event}}</td>
			<td>{{event.version}}</td>
			<td>{{event.time}}</td>
		</tr>
	{% endfor %}
	</tbody>
</table>

{% endblock %}
